name = "inneranimal-mcp"
main = "src/index.ts"
compatibility_date = "2026-01-20"
compatibility_flags = ["nodejs_compat"]
account_id = "ede6590ac0d2fb7daf155b35653457b2"

routes = [
  { pattern = "mcp.inneranimalmedia.com", zone_name = "inneranimalmedia.com", custom_domain = true },
  { pattern = "www.mcp.inneranimalmedia.com", zone_name = "inneranimalmedia.com", custom_domain = true },
]

workers_dev = false

# R2 buckets — agent-sam, inneranimalmedia-assets (for r2_list, r2_search, r2_bucket_summary)
[[r2_buckets]]
binding = "MCP_BUCKET"
bucket_name = "agent-sam"

[[r2_buckets]]
binding = "ASSETS_BUCKET"
bucket_name = "inneranimalmedia-assets"

# D1 — r2_object_inventory + human_context (for r2_search across inventoried buckets)
[[d1_databases]]
binding = "DB"
database_name = "inneranimalmedia-business"
database_id = "cf87b717-d4e2-4cf8-bab0-a81268e32d49"

# Static assets — auth page at /
[assets]
directory = "./static"
html_handling = "auto-trailing-slash"

# Remove old MyMCP Durable Object from previous deploy
[[migrations]]
tag = "v2"
deleted_classes = ["MyMCP"]

[vars]
ENVIRONMENT = "production"

# Secrets: CLOUDFLARE_API_TOKEN (for bindings/D1). Set in dashboard.
